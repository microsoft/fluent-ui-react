import replace from 'rollup-plugin-replace'
import resolve from 'rollup-plugin-node-resolve'
import commonjs from 'rollup-plugin-commonjs'

const lodashExports = [
  'compact',
  'difference',
  'each',
  'findIndex',
  'flow',
  'forEach',
  'get',
  'has',
  'filter',
  'first',
  'includes',
  'intersection',
  'invoke',
  'isArray',
  'isEmpty',
  'isFunction',
  'isNil',
  'isObject',
  'isPlainObject',
  'inRange',
  'isUndefined',
  'keys',
  'last',
  'map',
  'mapValues',
  'merge',
  'memoize',
  'min',
  'pick',
  'round',
  'set',
  'some',
  'sortBy',
  'startsWith',
  'sum',
  'take',
  'trim',
  'without',
  'union',
  'uniq',
  'uniqueId',
]

export default {
  input: 'app.js',
  output: {
    file: 'bundle.js',
    format: 'iife',
    sourcemap: true,
  },
  plugins: [
    replace({
      'process.env.NODE_ENV': JSON.stringify('development'),
    }),
    resolve(),
    commonjs({
      include: 'node_modules/**',
      namedExports: {
        'node_modules/keyboard-key/src/keyboardKey.js': [
          'ArrowDown',
          'ArrowUp',
          'ArrowLeft',
          'ArrowRight',
          'End',
          'Enter',
          'Escape',
          'Home',
          'getCode',
          'Spacebar',
          'Tab',
        ],
        'node_modules/lodash/fp.js': lodashExports,
        'node_modules/lodash/lodash.js': lodashExports,
        'node_modules/prop-types/index.js': [
          'any',
          'arrayOf',
          'bool',
          'element',
          'func',
          'node',
          'number',
          'object',
          'oneOf',
          'oneOfType',
          'shape',
          'string',
          'symbol',
        ],
        'node_modules/react/index.js': [
          'Component',
          'cloneElement',
          'createRef',
          'PureComponent',
          'Fragment',
          'Children',
          'createElement',
          'isValidElement',
        ],
        'node_modules/react-dom/index.js': ['createPortal', 'findDOMNode'],
        'node_modules/react-is/index.js': ['isForwardRef'],
        'node_modules/what-input/dist/what-input.js': ['ask'],
      },
    }),
  ],
}
